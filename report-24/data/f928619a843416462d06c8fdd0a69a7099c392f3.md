# Test info

- Name: TC-12 Verificar transacci√≥n exitosa
- Location: /home/runner/work/taller-playwright-atenea/taller-playwright-atenea/tests/transacciones.spec.ts:23:1

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toBeVisible()

Locator: getByText('Transferencia enviada a email1751484776470@valido.com')
Expected: visible
Received: <element(s) not found>
Call log:
  - expect.toBeVisible with timeout 5000ms
  - waiting for getByText('Transferencia enviada a email1751484776470@valido.com')

    at /home/runner/work/taller-playwright-atenea/taller-playwright-atenea/tests/transacciones.spec.ts:31:93
```

# Page snapshot

```yaml
- dialog "Enviar transferencia":
  - heading "Enviar transferencia" [level=2]
  - text: Email del destinatario *
  - textbox "Email del destinatario *"
  - text: Cuenta origen *
  - combobox "Cuenta origen *"
  - text: Monto a enviar *
  - spinbutton "Monto a enviar *"
  - button "Cancelar"
  - button "Enviar"
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 | import { DashboardPage } from '../pages/dashboardPage';
   3 | import { ModalEnviarTransferencia } from '../pages/modalEnviarTransferencia';
   4 | import TestData from '../data/testData.json';
   5 |
   6 | let dashboardPage: DashboardPage;
   7 | let modalEnviarTransferencia: ModalEnviarTransferencia;
   8 |
   9 | const testUsuarioEnvia = test.extend({
  10 |     storageState: require.resolve('../playwright/.auth/usuarioEnvia.json')
  11 | })
  12 |
  13 | const testUsuarioRecibe = test.extend({
  14 |     storageState: require.resolve('../playwright/.auth/usuarioRecibe.json')
  15 | })
  16 |
  17 | test.beforeEach(async ({ page }) => {
  18 |     dashboardPage = new DashboardPage(page);
  19 |     modalEnviarTransferencia = new ModalEnviarTransferencia(page);
  20 |     await dashboardPage.visitarPaginaDashboard();
  21 | })
  22 |
  23 | testUsuarioEnvia('TC-12 Verificar transacci√≥n exitosa', async ({ page }) => {
  24 |     testUsuarioEnvia.info().annotations.push({ 
  25 |         type: 'Informacion de usuario que recibe', 
  26 |         description: TestData.usuarioValido.email 
  27 |     });
  28 |     await expect(dashboardPage.dashboardTitle).toBeVisible();
  29 |     await dashboardPage.botonEnviarDinero.click();
  30 |     await modalEnviarTransferencia.completarYHacerClickBotonEnviar(TestData.usuarioValido.email, '100');
> 31 |     await expect(page.getByText('Transferencia enviada a ' + TestData.usuarioValido.email)).toBeVisible();
     |                                                                                             ^ Error: Timed out 5000ms waiting for expect(locator).toBeVisible()
  32 | })
  33 |
  34 | testUsuarioRecibe('TC-13 Verificar que usuario reciba la transferencia', async ({ page }) => {
  35 |     await expect(dashboardPage.dashboardTitle).toBeVisible();
  36 |     await expect(page.getByText('Transferencia de email').first()).toBeVisible();
  37 |
  38 | })
  39 |
```

# Local changes

```diff
diff --git a/.github/workflows/test.yml b/.github/workflows/test.yml
new file mode 100644
index 0000000..d777c10
--- /dev/null
+++ b/.github/workflows/test.yml
@@ -0,0 +1,111 @@
+name: CI - Clonando App y Ejecutando Tests
+
+on:
+  push:
+    branches: [main]
+  pull_request:
+    branches: [main]
+
+jobs:
+  test:
+    runs-on: ubuntu-latest
+
+    services:
+      mongo:
+        image: mongo:6.0
+        ports:
+          - 27017:27017
+
+    env:
+      MONGO_URI: ${{ secrets.MONGO_URI }}
+      JWT_SECRET: ${{ secrets.JWT_SECRET }}
+      PORT: 6007
+      VITE_API_BASE: http://localhost:6007/api
+
+    steps:
+      - name: Checkout repo actual (con el workflow)
+        uses: actions/checkout@v3
+
+      - name: Clonar repo Athena Redux Bank
+        run: |
+          git clone https://github.com/Atenea-Conocimientos/redux-athena-bank.git app
+
+      - name: Crear archivo .env para backend
+        run: |
+          echo "MONGO_URI=${{ env.MONGO_URI }}" >> app/backend/.env
+          echo "JWT_SECRET=${{ env.JWT_SECRET }}" >> app/backend/.env
+          echo "PORT=${{ env.PORT }}" >> app/backend/.env
+
+      - name: Instalar dependencias backend
+        run: |
+          cd app/backend
+          npm install
+
+      - name: Levantar backend
+        run: |
+          cd app/backend
+          npm run dev > backend.log 2>&1 &
+        env:
+          MONGO_URI: ${{ env.MONGO_URI }}
+          JWT_SECRET: ${{ env.JWT_SECRET }}
+          PORT: ${{ env.PORT }}
+
+      - name: Instalar wait-on
+        run: npm install -g wait-on
+
+      - name: Esperar backend
+        run: wait-on tcp:6007
+
+      - name: Instalar dependencias frontend
+        run: |
+          cd app/frontend
+          npm install
+
+      - name: Levantar frontend
+        run: |
+          cd app/frontend
+          npm run dev > frontend.log 2>&1 &
+        env:
+          VITE_API_BASE: ${{ env.VITE_API_BASE }}
+
+      - name: Esperar frontend
+        run: wait-on http://localhost:3000
+
+      - name: Instalar y correr tests (proyectos setup + chromium)
+        run: |
+          npm install
+          npx playwright install
+          npx playwright test --reporter=html
+
+      - name: Guardar reportes como artifacts
+        if: always()
+        uses: actions/upload-artifact@v4
+        with:
+          name: playwright-report
+          path: ./playwright-report
+
+      - name: Deploy Playwright report to GitHub Pages
+        if: always()
+        run: |
+          git config --global user.name "github-actions[bot]"
+          git config --global user.email "github-actions[bot]@users.noreply.github.com"
+
+          # Clonar gh-pages branch en carpeta temporal
+          cd $RUNNER_TEMP
+          git clone --depth=1 --branch=gh-pages https://x-access-token:${{ secrets.GH_PAGES_PAT }}@github.com/${{ github.repository }} gh-pages
+
+          cd gh-pages
+
+          # Limpiar contenido viejo
+          rm -rf ./*
+
+          # Copiar nuevo contenido del reporte
+          mkdir -p report-${GITHUB_RUN_NUMBER}
+          cp -r $GITHUB_WORKSPACE/playwright-report/* ./report-${GITHUB_RUN_NUMBER}
+
+
+          # Commit y push
+          git add .
+          git commit -m "üìä Reporte Playwright - Build $GITHUB_RUN_NUMBER"
+          git push origin gh-pages
+
diff --git a/playwright.config.ts b/playwright.config.ts
index e87c6b9..ae0df10 100644
--- a/playwright.config.ts
+++ b/playwright.config.ts
@@ -18,9 +18,9 @@ export default defineConfig({
   /* Fail the build on CI if you accidentally left test.only in the source code. */
   forbidOnly: !!process.env.CI,
   /* Retry on CI only */
-  retries: process.env.CI ? 2 : 0,
+  retries: process.env.CI ? 2 : 1,
   /* Opt out of parallel tests on CI. */
-  workers: process.env.CI ? 1 : undefined,
+  workers: process.env.CI ? 3 : undefined,
   /* Reporter to use. See https://playwright.dev/docs/test-reporters */
   reporter: 'html',
   /* Shared settings for all the projects below. See https://playwright.dev/docs/api/class-testoptions. */
diff --git a/tests/registro.setup.ts b/tests/registro.setup.ts
index a33a811..9e70979 100644
--- a/tests/registro.setup.ts
+++ b/tests/registro.setup.ts
@@ -30,10 +30,15 @@ setup('Generar usuario que env√≠a dinero', async ({ page, request }) => {
     await page.context().storageState({ path: usuarioEnviaAuthFile });
 })
 
-setup('Loguearse con usuario que recibe dinero', async ({ page, request }) => {
-    await loginPage.completarYHacerClickBotonLogin(TestData.usuarioValido);
+
+setup('Crear, Loguearse y agregar cuenta usuario Valido', async ({ page, request }) => {
+    const nuevoUsuario = await BackendUtils.crearUsuarioPorAPI(request, TestData.usuarioValido, false);
+    await loginPage.completarYHacerClickBotonLogin(nuevoUsuario);
     await expect(dashboardPage.dashboardTitle).toBeVisible();
+    await dashboardPage.botonDeAgregarCuenta.click();
+    await modalCrearCuenta.seleccionarTipoDeCuenta('D√©bito');
+    await modalCrearCuenta.completarMonto('1000');
+    await modalCrearCuenta.botonCrearCuenta.click();
+    await expect(page.getByText('Cuenta creada exitosamente')).toBeVisible();
     await page.context().storageState({ path: usuarioRecibeAuthFile })
-})
-
-
+})
\ No newline at end of file
diff --git a/utils/backendUtils.ts b/utils/backendUtils.ts
index 7e5036b..b5cb85c 100644
--- a/utils/backendUtils.ts
+++ b/utils/backendUtils.ts
@@ -2,8 +2,13 @@ import { APIRequestContext, expect } from '@playwright/test';
 
 export class BackendUtils {
 
-  static async crearUsuarioPorAPI(request: APIRequestContext, usuario: any) {
-    const email = (usuario.email.split('@')[0]) + Date.now().toString() + '@' + usuario.email.split('@')[1];
+  static async crearUsuarioPorAPI(request: APIRequestContext, usuario: any , esNuevo: boolean = true) {
+    let email: string;
+    if (esNuevo) {
+    email = (usuario.email.split('@')[0]) + Date.now().toString() + '@' + usuario.email.split('@')[1];
+    } else {
+    email = usuario.email;
+    }
     const response = await request.post('http://localhost:6007/api/auth/signup', {
       headers: {
         'Accept': 'application/vnd.github.v3+json',
```